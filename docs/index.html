<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R Wrapper For Googledocs Java Library • roogledocs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R Wrapper For Googledocs Java Library">
<meta property="og:description" content="Programmatically substitute images, data and tables into a google doc. R library to perform limited interactions with google docs (and maybe one day slides) in R via the Java API library. The purpose being to support google docs as a platform for interactive development and documentation of data analysis in R for scientific publication, although it is not limited to this purpose. The workflow supported is a parallel documentation and analysis where a team of people are working collaboratively on documentation, whilst at the same time analysis is being performed and results updated repeatedly as a result of new data. In this environment updating numeric results, tabular data and figures in word documents manually becomes annoying. With roogledocs you can automate this a bit like a RMarkdown document, but with the added benefit that the content can be updated independently of the analysis, by the wider team.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">roogledocs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/web-only/roogledocs.html">Using roogledocs</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="roogledocs" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#roogledocs" class="anchor"></a>roogledocs</h1></div>

<p>R library to perform limited interactions with google docs (and maybe one day slides) in R via the Java API library. The purpose being to support google docs as a platform for interactive development and documentation of data analysis in R for scientific publication, although it is not limited to this purpose. The workflow supported is a parallel documentation and analysis where a team of people are working collaboratively on documentation, whilst at the same time analysis is being performed and results updated repeatedly as a result of new data. In this environment updating numeric results, tabular data and figures in word documents manually becomes annoying. With roogledocs you can automate this a bit like a RMarkdown document, but with the added benefit that the content can be updated independently of the analysis, by the wider team.</p>
<div id="installation-instructions" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-instructions" class="anchor"></a>Installation instructions</h2>
<p><code>roogledocs</code> is not on cran yet. Installation from this repo can be done as follows:</p>
<div class="sourceCode"><pre class="downlit">
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"terminological/roogledocs"</span><span class="op">)</span></pre></div>
</div>
<div id="r-library-documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#r-library-documentation" class="anchor"></a>R library documentation</h2>
<p><a href="https://terminological.github.io/roogledocs/docs/">The R package site is here</a></p>
</div>
<div id="simple-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-usage" class="anchor"></a>Simple usage</h2>
<div class="sourceCode"><pre class="downlit">

<span class="co"># These options control whether roogledocs is disabled globally (useful for testing)</span>
<span class="co"># and where it stores the Google Drive authentication tokens</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">'roogledocs.disabled'</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"roogledocs.tokenDirectory"</span><span class="op">=</span><span class="st">"~/.roogledocs"</span><span class="op">)</span>

<span class="va">paper</span> <span class="op">=</span> <span class="fu">roogledocs</span><span class="fu">::</span><span class="fu"><a href="reference/doc_by_name.html">doc_by_name</a></span><span class="op">(</span><span class="st">"my-new-nature-paper"</span><span class="op">)</span>
<span class="va">paper</span><span class="op">$</span><span class="fu">updateFigure</span><span class="op">(</span><span class="st">"/full/path/to/figure-1.png"</span>, figureIndex <span class="op">=</span> <span class="fl">1</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></pre></div>
<p>Which will authenticate you, create a blank document (or retrieve it if it exists) and updates the first figure in the document, or inserts it at the end if no images exist already.</p>
<p>After some editing of the document and further analysis you are ready for a new version of the figure:</p>
<pre class="{r}"><code>paper$updateFigure("/full/path/to/figure-1-v2.png", figureIndex = 1, dpi = 300)</code></pre>
<p>Which updates the figure leaving the rest of the google doc content in place. Clearly this can be combined with ggplot to produce a seamless scripted data pipeline, one output of which is a google doc. This can be executed in RMarkdown, in which case the markdown can be a notebook documenting the code and methodology, and the google doc is the write up.</p>
</div>
<div id="development-notes" class="section level2">
<h2 class="hasAnchor">
<a href="#development-notes" class="anchor"></a>Development notes</h2>
<p>This library uses an R-code generation process <code>r6-generator-maven-plugin</code> and <code>rJava</code>.</p>
<p>For Google API OAuth a client id is required. This repository does not include the client_secrets.json file for this but this must be included as a symbolic link when project is cloned and BEFORE running <code>mvn install</code>. Installation will not fail without it but the resulting library will not work. This is only of relevance for development. For use it is all bundled</p>
<p>To do this you must get a client_secret.json file from:</p>
<ul>
<li><a href="https://developers.google.com/identity/protocols/oauth2" class="uri">https://developers.google.com/identity/protocols/oauth2</a></li>
<li><a href="https://console.cloud.google.com/apis/credentials?project=your_project_name" class="uri">https://console.cloud.google.com/apis/credentials?project=your_project_name</a></li>
</ul>
<p>You are requesting a OAuth client id; type “desktop application”. The client_secret.json file should then be saved outside of the github repository, and symbolic linked to the <code>src/main/resources</code> directory. Symbolic links are implicitly ignored by github, but it should also be explicitly excluded by <code>.gitignore</code>:</p>
<p>e.g. in my case:</p>
<pre><code>cd ~/Git/roogledocs/src/main
mkdir resources
cd resources
ln -s ~/Dropbox/roogledocs/client_secret.json
cd ~/Git/roogledocs
mvn install</code></pre>
<p>and then in R:</p>
<div class="sourceCode"><pre class="downlit">
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html">load_all</a></span><span class="op">(</span><span class="st">"~/Git/roogledocs"</span>,force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p>N.b. When you make changes to the java part of the library there are sometimes some caching issues. Full restart of R maybe required, and rebuild all data. Tweaking the library whilst doing a complex analysis is generally not a good idea (from experience).</p>
<div id="client-secrets" class="section level3">
<h3 class="hasAnchor">
<a href="#client-secrets" class="anchor"></a>Client secrets</h3>
<p>Are the OAuth client secrets really necessarily secret?</p>
<p>Generic answer for google secrets:</p>
<p><a href="https://stackoverflow.com/questions/62315535/are-there-any-security-concerns-with-sharing-the-client-secrets-of-a-google-api" class="uri">https://stackoverflow.com/questions/62315535/are-there-any-security-concerns-with-sharing-the-client-secrets-of-a-google-api</a></p>
<p>But difference between OAuth client id secret and types discussed on <a href="https://developers.google.com/identity/protocols/oauth2">this page</a> which states:</p>
<p>“Installed applications: The Google OAuth 2.0 endpoint supports applications that are installed on devices such as computers, mobile devices, and tablets. When you create a client ID through the Google API Console, specify that this is an Installed application, then select Android, Chrome app, iOS, Universal Windows Platform (UWP), or Desktop app as the application type.</p>
<p>The process results in a client ID and, in some cases, a client secret, which you embed in the source code of your application. (In this context, the client secret is obviously not treated as a secret.)"</p>
<p>Which suggests this is not an issue in this situation. In either event storing the raw client_secrets.json file in github seems lika a bad idea. However as github is the distribution method of the library it is not actually possible to totally avoid all security issues.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing roogledocs</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Rob Challen <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-5504-7768" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/terminological/roogledocs/actions"><img src="https://github.com/terminological/roogledocs/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/475030092"><img src="https://zenodo.org/badge/475030092.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Rob Challen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
