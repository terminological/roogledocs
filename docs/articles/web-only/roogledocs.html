<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using roogledocs • roogledocs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Using roogledocs">
<meta property="og:description" content="roogledocs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">roogledocs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/web-only/roogledocs.html">Using roogledocs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using roogledocs</h1>
                        <h4 class="author">Rob Challen</h4>
            
      
      
      <div class="hidden name"><code>roogledocs.Rmd</code></div>

    </div>

    
    
<div id="initialising-the-library" class="section level2">
<h2 class="hasAnchor">
<a href="#initialising-the-library" class="anchor"></a>Initialising the library</h2>
<p>Prior to doing any analysis we may have some form of template. This might be a document skeleton or report template. It can contain empty tables, placeholder images, and double-brace tags, all of which can be replaced by real content from R. To do this we initialise the Roogledocs library. There is a global flag to disable roogledocs in case you want to develop and test offline. Before pushing the result of the analysis to the google doc.</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">J</span> <span class="op">=</span> <span class="fu">roogledocs</span><span class="fu">::</span><span class="va"><a href="../../reference/JavaApi.html">JavaApi</a></span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span>
<span class="co">## Initialising R wrapper for Googledocs java library</span>
<span class="co">## Version: 0.0.3.9999</span>
<span class="co">## Generated: 2022-07-08T00:08:10.429</span>
<span class="co">## Calculating classpath and updating dependencies, please be patient.</span>
<span class="co">## Dependencies updated</span>
<span class="co">## 2022-07-08 00:08:22,405 INFO roogledocs [main] Initialised roogledocs</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">'roogledocs.disabled'</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">doc</span> <span class="op">=</span> <span class="va">J</span><span class="op">$</span><span class="va">RoogleDocs</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
<span class="co">## 2022-07-08 00:08:22,416 INFO org.github.terminological.roogledocs.RService [main] Initialising RoogleDocs. Local token directory: /home/terminological/.roogledocs</span></pre></div>
<p>Most of the time you will be creating or updating a single document. For this vignettes sake it is useful to be able to delete previous versions. The posint of roogledocs though is actually to work with a continuously updated document and therefore deleting documents is usually not what you want to do. Likewise for this vignette it is useful to get a copy of the googledoc as a PDF from R. This may not be that useful in real life. The main function here though is the "findOfCloneTemplate" which lets you find a google doc by name, or clone a template document if you can't find it. There are also equivalent methods to find or create blank documents, or just find google docs by name or sharing URL if they already exist.</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">doc</span><span class="op">$</span><span class="fu">deleteDocument</span><span class="op">(</span><span class="st">"roogledocs-demo"</span>,<span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## 2022-07-08 00:08:23,975 INFO org.github.terminological.roogledocs.RService [main] Deleting file: roogledocs-demo</span>
<span class="va">doc</span><span class="op">$</span><span class="fu">findOrCloneTemplate</span><span class="op">(</span><span class="st">"roogledocs-demo"</span>,<span class="st">"https://docs.google.com/document/d/1XnrBgBJFz7jEMYtw3o3YKbOuMdWvUkzIul4hb2B-SC4/edit?usp=sharing"</span><span class="op">)</span>
<span class="co">## 2022-07-08 00:08:28,627 INFO org.github.terminological.roogledocs.RService [main] Created new document with title: roogledocs-demo</span>
<span class="va">doc</span><span class="op">$</span><span class="fu">saveAsPdf</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"docs/articles/example-template-doc.pdf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span></pre></div>
<p>Running the chunk above should authenticate you and grab a publicly shared template I created, and make a copy of it in your google drive under the name "roogledocs-demo". <a href="example-template-doc.pdf">The document template can be seen here</a>, or as the <a href="https://docs.google.com/document/d/1XnrBgBJFz7jEMYtw3o3YKbOuMdWvUkzIul4hb2B-SC4/edit?usp=sharing">original google doc</a>.</p>
</div>
<div id="tabular-data" class="section level1">
<h1 class="hasAnchor">
<a href="#tabular-data" class="anchor"></a>Tabular data</h1>
<p>Inserting tables in this document is done by index. There is already a blank table 1 in the document. At the moment we support only huxtable tables. The following chunk creates a sample huxtable from the diamonds data set, applies some formatting and replaces the content of table one in the template with this data. The formatting is preserved more or less. There is only support for basic text formatting, borders (black solid only at present), background colour, and alignment. The table will repect column widths as a relative measure and the command takes a overall table width parameter. Layout will then depend on the content. Custom row heights are not supported.</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">hux</span> <span class="op">=</span> <span class="va">diamonds</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>colorCat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">color</span> <span class="op">&lt;=</span> <span class="st">"G"</span>, <span class="st">"D-G"</span>,<span class="st">"G-J"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">cut</span>,<span class="va">colorCat</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span>
  `Size (mean + sd)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%1.2f \u00B1 %1.2f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">carat</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">carat</span><span class="op">)</span><span class="op">)</span>,
  `Cost (mean + sd)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%1.0f \u00B1 %1.0f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">huxtable</span><span class="fu">::</span><span class="fu"><a href="https://hughjonesd.github.io/huxtable/reference/as_huxtable.html">as_hux</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">huxtable</span><span class="fu">::</span><span class="fu"><a href="https://hughjonesd.github.io/huxtable/reference/themes.html">theme_article</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">huxtable</span><span class="fu">::</span><span class="fu"><a href="https://hughjonesd.github.io/huxtable/reference/merge_repeated_rows.html">merge_repeated_rows</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## `summarise()` has grouped output by 'cut'. You can override using the `.groups` argument.</span>

<span class="va">hux</span> <span class="op">%&gt;%</span> <span class="fu">roogledocs</span><span class="fu">::</span><span class="fu">as.long_format_table</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">doc</span><span class="op">$</span><span class="fu">updateTable</span><span class="op">(</span>tableIndex <span class="op">=</span> <span class="fl">1</span>,tableWidthInches <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="co">## Adding missing grouping variables: `maxRow`</span>
<span class="co">## Table 1 updated</span>

<span class="va">hux</span></pre></div>
<table class="table huxtable">
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">cut</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">colorCat</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Size (mean + sd)</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Cost (mean + sd)</th>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Fair</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.93 ± 0.43</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">3997 ± 3312</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.24 ± 0.58</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">4972 ± 3873</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Good</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.78 ± 0.39</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">3620 ± 3380</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.00 ± 0.54</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">4610 ± 4194</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Very Good</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.72 ± 0.39</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">3587 ± 3666</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.00 ± 0.54</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">4873 ± 4358</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Premium</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.79 ± 0.44</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">4060 ± 4044</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.11 ± 0.59</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">5633 ± 4732</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Ideal</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.63 ± 0.36</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">3151 ± 3562</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.88 ± 0.53</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">4233 ± 4273</td>
</tr>
</table>
</div>
<div id="updating-figures" class="section level1">
<h1 class="hasAnchor">
<a href="#updating-figures" class="anchor"></a>Updating figures</h1>
<p>A similar process for figures. We need to have the figure as a PNG image on the local computer as a result of for example a ggplot. Once a local PNG is available, it is temporarily uploaded to your google drive, added to the document and then temporary drive file deleted. If you want copies for journal submission that is up to you to manage locally. In this example we update figure 1:</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">carat</span>,y<span class="op">=</span><span class="va">price</span>, colour<span class="op">=</span><span class="va">color</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span>
<span class="va">filename</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".png"</span><span class="op">)</span>
<span class="fu">ggsave</span><span class="op">(</span><span class="va">filename</span>, <span class="va">g</span>, width<span class="op">=</span><span class="fl">6</span>, height<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">filename</span> <span class="op">%&gt;%</span> <span class="va">doc</span><span class="op">$</span><span class="fu">updateFigure</span><span class="op">(</span>figureIndex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">## 2022-07-08 00:08:34,282 INFO org.github.terminological.roogledocs.RService [main] Uploading: file3f737fdb95ee.png; with type: image/png</span>
<span class="co">## Figure 1 updated</span>
<span class="co">## 2022-07-08 00:08:40,164 INFO org.github.terminological.roogledocs.RService [main] Deleting file: file3f737fdb95ee.png</span>
<span class="va">g</span></pre></div>
<p><img src="roogledocs_files/figure-html/fig1-1.png" width="700"></p>
<p>Updating a second figure will happen in the same way. The dimensions of the image in the google doc should exactly match the dimensions of the PNG file saved from R. This means if you change the size of an image in R it will be changed in the document. Image dimensions are therefore important to decide on in R. If the figure or table had not already existed in the target google doc (e.g. because you started with a blank document) they would simply have been uploaded and added at the end of the document as a sequentially numbered image. If you rearrange the order figures in the google doc it is up to you to fix the indexes in your code. Captions are not handled here at all as it is assumed that the captions will be maintained in the google doc and not in R (see "Updating tagged text" section later).</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">g2</span> <span class="op">=</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">cut</span>,y<span class="op">=</span><span class="va">price</span>, fill<span class="op">=</span><span class="va">cut</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_violin</span><span class="op">(</span>draw_quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.5</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">scale_fill_brewer</span><span class="op">(</span><span class="op">)</span>
<span class="va">filename</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".png"</span><span class="op">)</span>
<span class="fu">ggsave</span><span class="op">(</span><span class="va">filename</span>, <span class="va">g2</span>, width<span class="op">=</span><span class="fl">4</span>, height<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">filename</span> <span class="op">%&gt;%</span> <span class="va">doc</span><span class="op">$</span><span class="fu">updateFigure</span><span class="op">(</span>figureIndex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">## 2022-07-08 00:08:43,554 INFO org.github.terminological.roogledocs.RService [main] Uploading: file3f73578787b.png; with type: image/png</span>
<span class="co">## Figure 2 updated</span>
<span class="co">## 2022-07-08 00:08:48,818 INFO org.github.terminological.roogledocs.RService [main] Deleting file: file3f73578787b.png</span>
<span class="va">g2</span></pre></div>
<p><img src="roogledocs_files/figure-html/fig2-1.png" width="700"></p>
</div>
<div id="updating-tagged-text" class="section level1">
<h1 class="hasAnchor">
<a href="#updating-tagged-text" class="anchor"></a>Updating tagged text</h1>
<p>If you want to update small textual results - e.g. results in the abstract of a paper (similar to RMarkdown inline chunks) you can place a double-brace tag into the google doc and replace this with text generated in R. The result is held as a named range in the google doc so that further changes or updates in code will be propagated through. This named range however can be lost if a user copy and pastes the replaced tagged text. In this case the tags will have to be manually put back in. You can get a list of the tags present in a document like this:</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">doc</span><span class="op">$</span><span class="fu">tagsDefined</span><span class="op">(</span><span class="op">)</span>
<span class="co">## </span></pre></div>
<table class="table huxtable">
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">tag</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">count</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">table-1-update-date</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">diamonds-mean-sd</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td>
</tr>
</table>
<p>Here we have 2 tags. The tags can be then set to specific content like this:</p>
<div class="sourceCode"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"%d/%m/%Y"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">doc</span><span class="op">$</span><span class="fu">updateTaggedText</span><span class="op">(</span>tagName <span class="op">=</span> <span class="st">"table-1-update-date"</span><span class="op">)</span>
<span class="co">## 2022-07-08 00:08:51,198 INFO org.github.terminological.roogledocs.RDocument [main] Autotext replacing: {{table-1-update-date}} with 08/07/2022</span>
<span class="co">## Text table-1-update-date updated</span>
<span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%1.1f \u00B1 %1.1f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">$</span><span class="va">price</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">$</span><span class="va">price</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">doc</span><span class="op">$</span><span class="fu">updateTaggedText</span><span class="op">(</span>tagName <span class="op">=</span> <span class="st">"diamonds-mean-sd"</span><span class="op">)</span>
<span class="co">## 2022-07-08 00:08:52,344 INFO org.github.terminological.roogledocs.RDocument [main] Autotext replacing: {{diamonds-mean-sd}} with 3932.8 ± 3989.4</span>
<span class="co">## Text diamonds-mean-sd updated</span></pre></div>
<p>If you want to do a lot of copy pasting, or the tags have become broken, you may need to revert all the tags in a document so you can easily see where the good tags are (or to identify if some tags have been lost by copy paste). This can be done with the <code>doc$revertTags()</code> function, which puts the double-brace tags back in the document removing the auto-text. It is possible to use this kind of approach to automatically add in captions for figures or tables. It is technically possible to substitute images for double-brace tags also. This is not as convenient in my view as simply updating by index but may be necessary in certain circumstances.</p>
</div>
<div id="new-content" class="section level1">
<h1 class="hasAnchor">
<a href="#new-content" class="anchor"></a>New Content</h1>
<p>Appending new content is also possible either as a simple styled text string, with consistent formatting, or as a continuous block (or blocks) with different styles, as specified in a dataframe. At the moment this is only possible at the end of the document and is really designed if a document is being generated completely from scratch. A minimal subset of text formatting is supported although by using named styles to can do more. It is not actually that hard to support more styles.</p>
<div class="sourceCode"><pre class="downlit">

<span class="va">doc</span><span class="op">$</span><span class="fu">appendText</span><span class="op">(</span><span class="st">"\nAdding new content\n"</span>,<span class="st">"HEADING_3"</span><span class="op">)</span>
<span class="co">## </span>

<span class="va">content</span> <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">label</span>, <span class="op">~</span><span class="va">link</span>, <span class="op">~</span><span class="va">fontName</span>, <span class="op">~</span><span class="va">fontFace</span>,
  <span class="st">"Roogledocs"</span>, <span class="st">"https://terminological.github.io/roogledocs/r-library/docs/"</span>, <span class="st">"Courier New"</span>, <span class="st">"plain"</span>,
  <span class="st">" is also able to add text at the end of the document with complex formatting. "</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"plain"</span>,
  <span class="st">"Supporting fonts and font face formatting such as "</span>,  <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"plain"</span>,
  <span class="st">"bold, "</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"bold"</span>,
  <span class="st">"italic "</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"italic"</span>,
  <span class="st">"and underlined"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"underlined"</span>,
  <span class="st">" amongst other things."</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"plain"</span>
  <span class="op">)</span>
<span class="va">content</span></pre></div>
<table class="table huxtable">
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">label</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">link</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">fontName</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">fontFace</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Roogledocs</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">https://terminological.github.io/roogledocs/r-library/docs/</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Courier New</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">plain</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> is also able to add text at the end of the document with complex formatting. </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">plain</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Supporting fonts and font face formatting such as </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">plain</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">bold, </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">bold</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">italic </td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">italic</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">and underlined</td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">underlined</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"> amongst other things.</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">plain</td>
</tr>
</table>
<div class="sourceCode"><pre class="downlit">

<span class="va">doc</span><span class="op">$</span><span class="fu">appendFormattedParagraph</span><span class="op">(</span><span class="va">content</span><span class="op">)</span>
<span class="co">## </span></pre></div>
<p>It could be possible to combine writing new content and updating tagged text in the same script to programmatically generate replacement content. Likewise this could be used for captions of tables and figures when they are added. When you write new content you can write in double-brace tags and these can then be updated at a later stage for example.</p>
<p>Finally we can write out the new document to a PDF, mostly so we can see what we have done:</p>
<div class="sourceCode"><pre class="downlit">
<span class="va">doc</span><span class="op">$</span><span class="fu">saveAsPdf</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"docs/articles/example-after-update.pdf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span></pre></div>
<p>After the analysis has run we have a new version of the google document <a href="example-after-update.pdf">which should look like this</a>.</p>
</div>
<div id="limitations-and-further-options" class="section level1">
<h1 class="hasAnchor">
<a href="#limitations-and-further-options" class="anchor"></a>Limitations and further options</h1>
<p>There are a lot of possible ways to extend this. The current implementation is a minimally viable product, really designed to support my own use.</p>
<ul>
<li>For example, additional formatting options such as text colour, or table padding is not implemented but would be relatively straightforward.</li>
<li>It feels simple to extend the tables to handle flextables and possibly others.</li>
<li>Currently there is no support for bulleted lists, which is fairly simple, but I didn't have a good use case.</li>
<li>Absolutely positioned images are ignored completely. This is probably a good thing as it lets you have a logo within the document for example without messing up the dynamic images from R.</li>
<li>Building a google docs based drop in for the <code>officer</code> library for MS word could be good if it means we can leverage that interface for other uses (e.g. knitr support).</li>
<li>A fairly complex development would be support for google slides, although a very simple tagged text and image substitution equivalent might be simple, in reality for this you are likely to want to do more complex operations.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Rob Challen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
