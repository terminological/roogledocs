<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="roogledocs">
<title>Using roogledocs for documents • roogledocs</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Using roogledocs for documents">
<meta property="og:description" content="roogledocs">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">roogledocs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/placeholder.html">Placeholder</a>
    <a class="dropdown-item" href="../../articles/web-only/roogledocs.html">Using roogledocs for documents</a>
    <a class="dropdown-item" href="../../articles/web-only/roogleslides.html">Using roogledocs for presentations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/terminological/roogledocs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Using roogledocs for documents</h1>
                        <h4 data-toc-skip class="author">Rob
Challen</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/terminological/roogledocs/blob/HEAD/vignettes/web-only/roogledocs.Rmd" class="external-link"><code>vignettes/web-only/roogledocs.Rmd</code></a></small>
      <div class="d-none name"><code>roogledocs.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/remove.packages.html" class="external-link">remove.packages</a></span><span class="op">(</span><span class="st">"roogledocs"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_local.html" class="external-link">install_local</a></span><span class="op">(</span><span class="st">"~/Git/roogledocs"</span>,upgrade <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="initialising-the-library">Initialising the library<a class="anchor" aria-label="anchor" href="#initialising-the-library"></a>
</h3>
<p>Prior to doing any analysis we may have some form of template. This
might be a document skeleton or report template. It can contain empty
tables, place-holder images, and double-brace tags, all of which can be
replaced by calculated content from R. To do this we initialise the
<code>roogledocs</code> library.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># There is a global flag to disable `roogledocs` in case you want to develop and</span></span>
<span><span class="co"># test offline.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">'roogledocs.disabled'</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># roogledocs stores an authentication token on your local hard drive.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"roogledocs.tokenDirectory"</span><span class="op">=</span><span class="st">"~/.roogledocs-test"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">J</span> <span class="op">=</span> <span class="fu">roogledocs</span><span class="fu">::</span><span class="va"><a href="../../reference/JavaApi.html">JavaApi</a></span><span class="op">$</span><span class="fu">get</span><span class="op">(</span>logLevel <span class="op">=</span> <span class="st">"DEBUG"</span><span class="op">)</span></span>
<span><span class="co">## 2024-01-17 15:16:30,938 main DEBUG null null initializing configuration org.apache.logging.log4j.core.config.builder.impl.BuiltConfiguration@33723e30</span></span>
<span><span class="co">## 2024-01-17 15:16:30,949 main DEBUG PluginManager 'Core' found 127 plugins</span></span>
<span><span class="co">## 2024-01-17 15:16:30,949 main DEBUG PluginManager 'Level' found 0 plugins</span></span>
<span><span class="co">## 2024-01-17 15:16:30,954 main DEBUG PluginManager 'Lookup' found 16 plugins</span></span>
<span><span class="co">## 2024-01-17 15:16:30,955 main DEBUG Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].</span></span>
<span><span class="co">## 2024-01-17 15:16:30,962 main DEBUG PluginManager 'TypeConverter' found 26 plugins</span></span>
<span><span class="co">## 2024-01-17 15:16:30,966 main DEBUG createAppenderRef(ref="Console", level="null", Filter=null)</span></span>
<span><span class="co">## 2024-01-17 15:16:30,966 main DEBUG Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].</span></span>
<span><span class="co">## 2024-01-17 15:16:30,970 main DEBUG LoggerConfig$RootLogger$Builder(additivity="null", level="DEBUG", levelAndRefs="null", includeLocation="null", ={Console}, ={}, Configuration(DefaultLogger), Filter=null)</span></span>
<span><span class="co">## 2024-01-17 15:16:30,971 main DEBUG Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].</span></span>
<span><span class="co">## 2024-01-17 15:16:30,971 main DEBUG createLoggers(={root})</span></span>
<span><span class="co">## 2024-01-17 15:16:30,971 main DEBUG Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].</span></span>
<span><span class="co">## 2024-01-17 15:16:30,973 main DEBUG PatternLayout$Builder(pattern="%m%n", PatternSelector=null, Configuration(DefaultLogger), Replace=null, charset="null", alwaysWriteExceptions="null", disableAnsi="null", noConsoleNoAnsi="null", header="null", footer="null")</span></span>
<span><span class="co">## 2024-01-17 15:16:30,974 main DEBUG PluginManager 'Converter' found 45 plugins</span></span>
<span><span class="co">## 2024-01-17 15:16:30,980 main DEBUG Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].</span></span>
<span><span class="co">## 2024-01-17 15:16:30,984 main DEBUG ConsoleAppender$Builder(target="SYSTEM_OUT", follow="null", direct="null", bufferedIo="null", bufferSize="null", immediateFlush="null", ignoreExceptions="null", PatternLayout(%m%n), name="Console", Configuration(DefaultLogger), Filter=null, ={})</span></span>
<span><span class="co">## 2024-01-17 15:16:30,986 main DEBUG Starting OutputStreamManager SYSTEM_OUT.false.false</span></span>
<span><span class="co">## 2024-01-17 15:16:30,986 main DEBUG Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].</span></span>
<span><span class="co">## 2024-01-17 15:16:30,986 main DEBUG createAppenders(={Console})</span></span>
<span><span class="co">## 2024-01-17 15:16:30,986 main DEBUG Configuration org.apache.logging.log4j.core.config.builder.impl.BuiltConfiguration@33723e30 initialized</span></span>
<span><span class="co">## WARNING: sun.reflect.Reflection.getCallerClass is not supported. This will impact performance.</span></span>
<span><span class="co">## 2024-01-17 15:16:30,988 main DEBUG PluginManager 'Lookup' found 16 plugins</span></span>
<span><span class="co">## 2024-01-17 15:16:30,989 main DEBUG PluginManager 'Lookup' found 16 plugins</span></span>
<span><span class="co">## 2024-01-17 15:16:30,989 main DEBUG PluginManager 'Converter' found 45 plugins</span></span>
<span><span class="co">## 2024-01-17 15:16:30,994 main DEBUG Starting OutputStreamManager SYSTEM_OUT.false.false-1</span></span>
<span><span class="co">## 2024-01-17 15:16:30,994 main DEBUG Starting LoggerContext[name=Default, org.apache.logging.log4j.core.LoggerContext@402e37bc] with configuration org.apache.logging.log4j.core.config.builder.impl.BuiltConfiguration@33723e30...</span></span>
<span><span class="co">## 2024-01-17 15:16:30,995 main DEBUG Shutdown hook enabled. Registering a new one.</span></span>
<span><span class="co">## 2024-01-17 15:16:30,998 main DEBUG Starting configuration org.apache.logging.log4j.core.config.builder.impl.BuiltConfiguration@33723e30</span></span>
<span><span class="co">## 2024-01-17 15:16:30,998 main DEBUG Started configuration org.apache.logging.log4j.core.config.builder.impl.BuiltConfiguration@33723e30 OK.</span></span>
<span><span class="co">## 2024-01-17 15:16:30,998 main DEBUG Shutting down OutputStreamManager SYSTEM_OUT.false.false-1</span></span>
<span><span class="co">## 2024-01-17 15:16:30,998 main DEBUG OutputStream closed</span></span>
<span><span class="co">## 2024-01-17 15:16:30,999 main DEBUG Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true</span></span>
<span><span class="co">## 2024-01-17 15:16:30,999 main DEBUG Appender DefaultConsole-1 stopped with status true</span></span>
<span><span class="co">## 2024-01-17 15:16:30,999 main DEBUG Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@14ec4505 OK</span></span>
<span><span class="co">## 2024-01-17 15:16:31,057 main DEBUG org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.</span></span>
<span><span class="co">## 2024-01-17 15:16:31,057 main DEBUG LoggerContext[name=Default, org.apache.logging.log4j.core.LoggerContext@402e37bc] started OK with configuration org.apache.logging.log4j.core.config.builder.impl.BuiltConfiguration@33723e30.</span></span>
<span><span class="co">## Adding to classpath: </span></span>
<span><span class="co">## /tmp/RtmpYHFHtI/temp_libpath12be77aabe594/roogledocs/java/roogledocs-0.3.0-jar-with-dependencies.jar</span></span>
<span><span class="co">## Initialised roogledocs</span></span>
<span><span class="co">## R package version: 0.3.0</span></span>
<span><span class="co">## R package generated: 2024-01-17T13:26:56.091248658</span></span>
<span><span class="co">## Java library version: io.github.terminological:roogledocs:0.3.0</span></span>
<span><span class="co">## Java library compiled: 2024-01-17T15:16:04.153</span></span>
<span><span class="co">## Contact: rob.challen@bristol.ac.uk</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="va">J</span><span class="op">$</span><span class="va">RoogleDocs</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## Initialising RoogleDocs. Local token directory: /home/vp22681/.roogledocs-test</span></span></code></pre></div>
<p>Most of the time you will be creating or updating a single document.
For this vignettes sake it is useful to be able to delete previous
versions. The point of <code>roogledocs</code> though is actually to
work with a continuously updated document and therefore deleting
documents is usually not what you want to do. Likewise for this vignette
it is useful to get a copy of the Google doc as a PDF from R. This may
not be that useful in real life. The main function here though is the
<code>findOrCloneTemplate()</code> method which lets you find a Google
doc by name, or clone a template document if you can’t find it. There
are also equivalent methods to find or create blank documents, or just
find Google docs by name or sharing URL if they already exist.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">roogledocs</span><span class="fu">::</span><span class="fu"><a href="../../reference/delete_document.html">delete_document</a></span><span class="op">(</span><span class="st">"roogledocs-demo"</span>,areYouSure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## Deleting file: roogledocs-demo</span></span></code></pre></div>
<p>Sometimes (particularly if the <code>roogledocs</code> library has
been updated) we get a <code>TokenResponseException</code>, saying the
token has been expired or revoked. In this event explicitly
re-authenticating the library can be done though a call to
<code><a href="../../reference/reauth.html">roogledocs::reauth()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">roogledocs</span><span class="fu">::</span><span class="fu"><a href="../../reference/reauth.html">reauth</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Once authentication is working getting a</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doc</span> <span class="op">=</span> <span class="fu">roogledocs</span><span class="fu">::</span><span class="fu"><a href="../../reference/doc_from_template.html">doc_from_template</a></span><span class="op">(</span><span class="st">"roogledocs-demo"</span>,<span class="st">"https://docs.Google.com/document/d/1XnrBgBJFz7jEMYtw3o3YKbOuMdWvUkzIul4hb2B-SC4/edit?usp=sharing"</span><span class="op">)</span></span>
<span><span class="co">## Created new document with title: roogledocs-demo</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html" class="external-link">dir_create</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"docs/articles/web-only"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">doc</span><span class="op">$</span><span class="fu">saveAsPdf</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"docs/articles/web-only/example-template-doc.pdf"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Created new document with title: tmp_copy_for_pdf_5cfe08cc-d7c3-4e96-9e15-24d7b116defc</span></span>
<span><span class="co">## Deleting file: tmp_copy_for_pdf_5cfe08cc-d7c3-4e96-9e15-24d7b116defc</span></span></code></pre></div>
<p>Running the chunk above should authenticate you and grab a publicly
shared template I created, and make a copy of it in your Google drive
under the name “roogledocs-demo”. <a href="example-template-doc.pdf">The
document template can be seen here</a>, or as the <a href="https://docs.Google.com/document/d/1XnrBgBJFz7jEMYtw3o3YKbOuMdWvUkzIul4hb2B-SC4/edit?usp=sharing" class="external-link">original
Google doc</a>.</p>
</div>
<div class="section level2">
<h2 id="tabular-data">Tabular data<a class="anchor" aria-label="anchor" href="#tabular-data"></a>
</h2>
<p>Inserting tables in this document is done by index. There is already
a blank table 1 in the document. At the moment we support only
<code>huxtable</code> tables and plain data-frames. The following chunk
creates a sample <code>huxtable</code> from the diamonds data set,
applies some formatting and replaces the content of table one in the
template with this data. The formatting is preserved more or less. There
is only support for basic text formatting, borders (black solid only at
present), background colour, and alignment. The table will respect
column widths as a relative measure and the command takes a overall
table width parameter. Layout will then depend on the content. Custom
row heights are not supported.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hux</span> <span class="op">=</span> <span class="va">diamonds</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">mutate</span><span class="op">(</span>colorCat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">color</span> <span class="op">&lt;=</span> <span class="st">"G"</span>, <span class="st">"D-G"</span>,<span class="st">"G-J"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">group_by</span><span class="op">(</span><span class="va">cut</span>,<span class="va">colorCat</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">summarise</span><span class="op">(</span></span>
<span>  `Size (mean + sd)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%1.2f \u00B1 %1.2f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">carat</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">carat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  `Cost (mean + sd)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%1.0f \u00B1 %1.0f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">huxtable</span><span class="fu">::</span><span class="fu"><a href="https://hughjonesd.github.io/huxtable/reference/as_huxtable.html" class="external-link">as_hux</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">huxtable</span><span class="fu">::</span><span class="fu"><a href="https://hughjonesd.github.io/huxtable/reference/themes.html" class="external-link">theme_article</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">huxtable</span><span class="fu">::</span><span class="fu"><a href="https://hughjonesd.github.io/huxtable/reference/set-multiple.html" class="external-link">set_all_padding</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">huxtable</span><span class="fu">::</span><span class="fu"><a href="https://hughjonesd.github.io/huxtable/reference/merge_repeated_rows.html" class="external-link">merge_repeated_rows</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## `summarise()` has grouped output by 'cut'. You can override using the `.groups`</span></span>
<span><span class="co">## argument.</span></span>
<span></span>
<span><span class="va">table_1</span> <span class="op">=</span> <span class="va">hux</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">roogledocs</span><span class="fu">::</span><span class="fu"><a href="../../reference/as.long_format_table.html">as.long_format_table</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">doc</span><span class="op">$</span><span class="fu">updateTaggedTable</span><span class="op">(</span><span class="va">table_1</span>, tableWidthInches <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">## Autotext replacing: {{table_1}} with table</span></span>
<span></span>
<span><span class="va">hux</span></span></code></pre></div>
<table class="table huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:table1">
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: bold;">cut</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: bold;">colorCat</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: bold;">Size (mean + sd)</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: bold;">Cost (mean + sd)</th>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">Fair</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.93 ± 0.43</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">3997 ± 3312</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">1.24 ± 0.58</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">4972 ± 3873</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">Good</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.78 ± 0.39</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">3620 ± 3380</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">1.00 ± 0.54</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">4610 ± 4194</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">Very Good</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.72 ± 0.39</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">3587 ± 3666</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">1.00 ± 0.54</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">4873 ± 4358</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">Premium</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.79 ± 0.44</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">4060 ± 4044</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">1.11 ± 0.59</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">5633 ± 4732</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">Ideal</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">D-G</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.63 ± 0.36</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">3151 ± 3562</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">G-J</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">0.88 ± 0.53</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 0pt 0pt 0pt 0pt; font-weight: normal;">4233 ± 4273</td>
</tr>
</table>
</div>
<div class="section level2">
<h2 id="updating-figures">Updating figures<a class="anchor" aria-label="anchor" href="#updating-figures"></a>
</h2>
<p>A similar process exists for figures. We need to have the figure as a
PNG image on the local computer as a result of, for example, a ggplot.
Once a local PNG is available, it is temporarily uploaded to your Google
drive, added to the document and then temporary drive file deleted. In
this example we update figure 1 replacing the <code>{{figure_1}}</code>
tag in the original Google doc with the image:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">carat</span>,y<span class="op">=</span><span class="va">price</span>, colour<span class="op">=</span><span class="va">color</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">figure_1</span> <span class="op">=</span> <span class="fu">roogledocs</span><span class="fu">::</span><span class="fu"><a href="../../reference/ggplot_to_png.html">ggplot_to_png</a></span><span class="op">(</span><span class="va">g</span>, width<span class="op">=</span><span class="fl">6</span>, height<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If the first parameter is passed as a variable and no tag is given, </span></span>
<span><span class="co"># as in this example the variable name is used as the tag and the image is </span></span>
<span><span class="co"># inserted into the document at the location of the tag:</span></span>
<span></span>
<span><span class="va">doc</span><span class="op">$</span><span class="fu">updateTaggedImage</span><span class="op">(</span><span class="va">figure_1</span><span class="op">)</span></span>
<span><span class="co">## Uploading: file1367961967822.png; with type: image/png</span></span>
<span><span class="co">## Autotext replacing: {{figure_1}} with image: https://lh3.googleusercontent.com/drive-storage/ANtge_FeBrpwxw4ONJeU0x_WMv6Rbyr6OKSlmLALSwTO8-ILFIrZ94RVJIF6azMYuxYjG4g2C3_v_PMK5m90ZRAyWjhRt5BNZo7h5OjDCiQF1g=s16383</span></span>
<span><span class="co">## No requests made</span></span>
<span><span class="co">## Figure figure_1 updated</span></span>
<span><span class="co">## Deleting file: temp_79b0b033-d6a2-4213-b38b-a26fb19f9dd1.png</span></span>
<span></span>
<span><span class="co"># This is equivalent to:</span></span>
<span><span class="co"># doc$updateTaggedImage(figure_1, tagName = "figure_1")</span></span>
<span></span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="roogledocs_files/figure-html/fig1-1.png" width="700"></p>
<p>Updating a second figure can happen in the same way, but in this case
we use the alternative by specifying the index of insertion. The
dimensions of the image in the Google doc should exactly match the
dimensions of the PNG file saved from R. This means if you change the
size of an image in R it will be changed in the document. Image
dimensions are therefore important to decide on in R. If the figure or
table had not already existed in the target Google doc (e.g. because you
started with a blank document) they would simply have been uploaded and
added at the end of the document as a sequentially numbered image. If
you rearrange the order figures in the Google doc it is up to you to fix
the indexes in your code. Captions are not handled here at all as it is
assumed that the captions will be maintained in the Google doc and not
in R (see “Updating tagged text” section later).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g2</span> <span class="op">=</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">cut</span>,y<span class="op">=</span><span class="va">price</span>, fill<span class="op">=</span><span class="va">cut</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>draw_quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.5</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">15</span>, vjust<span class="op">=</span><span class="fl">1</span>,hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">filename</span> <span class="op">=</span> <span class="fu">roogledocs</span><span class="fu">::</span><span class="fu"><a href="../../reference/ggplot_to_png.html">ggplot_to_png</a></span><span class="op">(</span><span class="va">g2</span>, width<span class="op">=</span><span class="fl">4</span>, height<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The figure index has to be calculated with respect to any changes that have </span></span>
<span><span class="co"># already been made in the document. In this case inserting figure 1 before</span></span>
<span><span class="co"># means this is inserted in the right place, but it is up to the user to make </span></span>
<span><span class="co"># sure this is right.</span></span>
<span><span class="va">filename</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="va">doc</span><span class="op">$</span><span class="fu">updateFigure</span><span class="op">(</span>figureIndex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">## Uploading: file1367961dff21f.png; with type: image/png</span></span>
<span><span class="co">## Figure 2 updated</span></span>
<span><span class="co">## Deleting file: file1367961dff21f.png</span></span>
<span><span class="va">g2</span></span></code></pre></div>
<p><img src="roogledocs_files/figure-html/fig2-1.png" width="700"></p>
<p>Along with updating a figure within a document as a png it is useful
to also be able to keep a copy of the figure with the document in a
publication ready format such as pdf. We might also be generating
supplementary material / or data, and or tables in a separate word
document. In my work flow all of these are generated by R scripts.
Automatically uploading these documents to a folder in Google drive
makes managing the output of an analysis fairly straightforward. Because
Google Drive can have multiple files of the same name in the same
directory the behaviour must be specified if the file already
exists.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doc</span><span class="op">$</span><span class="fu">uploadSupplementaryFiles</span><span class="op">(</span>absoluteFilePath <span class="op">=</span> <span class="va">figure_1</span>,overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## Uploading: file1367961967822.png; with type: image/png</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="updating-tagged-text">Updating tagged text<a class="anchor" aria-label="anchor" href="#updating-tagged-text"></a>
</h2>
<p>If you want to update small textual results - e.g. results in the
abstract of a paper (similar to RMarkdown in-line chunks) you can place
a double-brace tag into the Google doc and replace this with text
generated in R. The result is inserted in the Google doc as a URL link
so that further changes or updates in code can find the tagged text.
Links like this can be moved around the document, or copied and pasted
without losing the tag. You can get a list of the tags present in a
document like this:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doc</span><span class="op">$</span><span class="fu">tagsDefined</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## No requests made</span></span></code></pre></div>
<table class="table huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:tags">
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">tag</th>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">count</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">table_1_update_date</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">table_1</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">cite:challen2019</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">cite:challen2021</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">references</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">cite:r6gen</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">figure_1</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">cite:roogledocs</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">diamonds_mean_sd</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2</td>
</tr>
</table>
<p>Here we have 2 tags. The tags can be then set to specific content
like this:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"%d/%m/%Y"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="va">doc</span><span class="op">$</span><span class="fu">updateTaggedText</span><span class="op">(</span>tagName <span class="op">=</span> <span class="st">"table_1_update_date"</span><span class="op">)</span></span>
<span><span class="co">## Autotext replacing: {{table_1_update_date}} with 17/01/2024</span></span>
<span><span class="co">## No requests made</span></span>
<span><span class="co">## Text table_1_update_date updated</span></span>
<span><span class="va">diamonds_mean_sd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%1.1f \u00B1 %1.1f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">$</span><span class="va">price</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">$</span><span class="va">price</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># if we don't give a specific tag name then the variable name is used:</span></span>
<span><span class="va">doc</span><span class="op">$</span><span class="fu">updateTaggedText</span><span class="op">(</span><span class="va">diamonds_mean_sd</span><span class="op">)</span></span>
<span><span class="co">## Autotext replacing: {{diamonds_mean_sd}} with 3932.8 ± 3989.4</span></span>
<span><span class="co">## No requests made</span></span>
<span><span class="co">## Text diamonds_mean_sd updated</span></span></code></pre></div>
<p>If the tags have become broken, you may need to revert all the tags
in a document so you can easily see where the good tags are (or to
identify if some tags have been lost by copy paste). This can be done
with the <code>doc$revertTags()</code> function, which puts the
double-brace tags back in the document removing the auto-text. It is
possible to use this kind of approach to automatically add in captions
for figures or tables.</p>
</div>
<div class="section level2">
<h2 id="new-content">New content<a class="anchor" aria-label="anchor" href="#new-content"></a>
</h2>
<p>Appending new content is also possible either as a simple styled text
string, with consistent formatting, or as a continuous block (or blocks)
with different styles, as specified in a data-frame. At the moment this
is only possible at the end of the document and is really designed if a
document is being generated completely from scratch. A minimal subset of
text formatting is supported although by using named styles you can do
more. It is not actually that hard to support more styles but at the
moment this is not the primary use case for <code>roogledocs</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">doc</span><span class="op">$</span><span class="fu">appendText</span><span class="op">(</span><span class="st">"\nAdding new content\n"</span>,<span class="st">"HEADING_1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">content</span> <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">label</span>, <span class="op">~</span><span class="va">link</span>, <span class="op">~</span><span class="va">fontName</span>, <span class="op">~</span><span class="va">fontFace</span>,</span>
<span>  <span class="st">"Roogledocs"</span>, <span class="st">"https://terminological.github.io/roogledocs/r-library/docs/"</span>, <span class="st">"Courier New"</span>, <span class="st">"plain"</span>,</span>
<span>  <span class="st">" is also able to add text at the end of the document with complex formatting. "</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"plain"</span>,</span>
<span>  <span class="st">"Supporting fonts and font face formatting such as "</span>,  <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"plain"</span>,</span>
<span>  <span class="st">"bold, "</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"bold"</span>,</span>
<span>  <span class="st">"italic "</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"italic"</span>,</span>
<span>  <span class="st">"and underlined"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"underlined"</span>,</span>
<span>  <span class="st">" amongst other things.\n\n"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"plain"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">doc</span><span class="op">$</span><span class="fu">appendFormattedParagraph</span><span class="op">(</span><span class="va">content</span><span class="op">)</span></span>
<span></span>
<span><span class="va">content</span></span></code></pre></div>
<table class="table huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:new-text">
<col>
<col>
<col>
<col>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">label</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">link</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">fontName</th>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">fontFace</th>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Roogledocs</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">https://terminological.github.io/roogledocs/r-library/docs/</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Courier New</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">plain</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> is also able to add text at the end of the document with complex formatting. </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">plain</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Supporting fonts and font face formatting such as </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">plain</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">bold, </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">bold</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">italic </td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">italic</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">and underlined</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">underlined</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"> amongst other things.<br><br>
</td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;"></td>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">plain</td>
</tr>
</table>
<p>It could be possible to combine writing new content and updating
tagged text in the same script to programmatically generate replacement
content. Likewise this could be used for captions of tables and figures
when they are added. When you write new content you can write in
double-brace tags and these can then be updated at a later stage for
example.</p>
<p>Citations are referenced as a tag of the format
<code>{{cite:XXXX;YYYY}}</code> where X and Y are bibtext ids.
References will be updated if present or if not</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">doc</span><span class="op">$</span><span class="fu">updateCitations</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/web-only/test.bib"</span><span class="op">)</span>, <span class="st">"ieee"</span><span class="op">)</span></span>
<span><span class="co">## No requests made</span></span>
<span><span class="co">## No requests made</span></span>
<span><span class="co">## No requests made</span></span></code></pre></div>
<p>Finally we can write out the new document to a PDF, mostly so we can
see what we have done. When we write out a document any
<code>roogledocs</code> links are removed:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doc</span><span class="op">$</span><span class="fu">saveAsPdf</span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"docs/articles/web-only/example-after-update.pdf"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Created new document with title: tmp_copy_for_pdf_78161468-d372-40ef-99a7-f3338bf7deb5</span></span>
<span><span class="co">## Deleting file: tmp_copy_for_pdf_78161468-d372-40ef-99a7-f3338bf7deb5</span></span></code></pre></div>
<p>After the analysis has run we have a new version of the Google
document which should <a href="example-after-update.pdf">look like
this</a>.</p>
</div>
<div class="section level2">
<h2 id="limitations-and-further-options">Limitations and further options<a class="anchor" aria-label="anchor" href="#limitations-and-further-options"></a>
</h2>
<p>There are a lot of possible ways to extend <code>roogledocs</code>.
The current implementation is in evolution to meet my own needs.</p>
<ul>
<li>For example, additional formatting options such as text colour is
not implemented but would be relatively straightforward.</li>
<li>Currently there is no support for lists, which should be fairly
simple, but I didn’t have a need yet.</li>
<li>Absolutely positioned images are ignored completely. This is
probably a good thing as it lets you have a logo within the document for
example without messing up the dynamic images from R.</li>
<li>Building a Google docs based drop in for the <code>officer</code>
library for MS word could be good if it means we can leverage that
interface for other uses (e.g. knitr support).</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rob Challen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
